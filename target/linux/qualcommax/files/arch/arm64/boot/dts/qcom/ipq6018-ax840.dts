/dts-v1/;
/*
 * Copyright (c) 2019, The Linux Foundation. All rights reserved.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

#include "ipq6018-gl-ax1800.dtsi"

/ {
	model = "Yuncore AX840";
	compatible = "yuncore,ax840", "qcom,ipq6018", "qcom,ipq6018-cp03";

	aliases {
		ethernet0 = &dp5;
		ethernet1 = &dp4;
		led-boot = &led_system;
		led-failsafe = &led_system;
		led-running = &led_system;
		led-upgrade = &led_system;
	};

	chosen {
		stdout-path = "serial0:115200n8";
		bootargs-append = " ubi.block=0,rootfs root=/dev/ubiblock0_1 earlycon debug";
	};

    keys {
        compatible = "gpio-keys";

        reset {
            label = "reset";
            gpios = <&tlmm 19 GPIO_ACTIVE_LOW>;
            linux,code = <KEY_RESTART>;
        };
    };

    leds {
        compatible = "gpio-leds";

        led_system: led_system {
            label = "system";
            gpios = <&tlmm 35 GPIO_ACTIVE_HIGH>;
            color = "red";
        };

        led_wlan2g: led_wlan2g {
            label = "wlan2g";
            gpios = <&tlmm 37 GPIO_ACTIVE_HIGH>;
            color = "green";
        };

        led_wlan5g: led_wlan25 {
            label = "wlan5g";
            gpios = <&tlmm 32 GPIO_ACTIVE_HIGH>;
            color = "blue";
        };
    };
};

&mdio {
	status = "okay";
	pinctrl-0 = <&mdio_pins>;
 	pinctrl-names = "default";
 	phy-reset-gpio = <&tlmm 75 0>;
	
	qca8075_3: ethernet-phy@0 {
		compatible = "ethernet-phy-ieee802.3-c22";
		reg = <3>;
	};

	qca8075_4: ethernet-phy@1 {
		compatible = "ethernet-phy-ieee802.3-c22";
		reg = <4>;
	};
};

&tlmm {

	mdio_pins: mdio_pinmux {
		mux_0 {
			pins = "gpio64";
			function = "mdc";
			drive-strength = <8>;
			bias-pull-up;
		};
		mux_1 {
			pins = "gpio65";
			function = "mdio";
			drive-strength = <8>;
			bias-pull-up;
		};
		mux_2 {
			pins = "gpio75";
			function = "gpio";
			bias-pull-up;
		};
	};
};

&switch {
	switch_cpu_bmp = <0x01>; /* cpu port bitmap */
	switch_lan_bmp = <0x10>; /* lan port bitmap */
	switch_wan_bmp = <0x20>; /* wan port bitmap */
	switch_inner_bmp = <0x80>; /* wan port bitmap */
	switch_mac_mode = <0x00>; 
	switch_mac_mode1 = <0xff>;
	switch_mac_mode1 = <0xff>;

	qcom,port_phyinfo {
		port@3 {
			port_id = <4>;
			phy_address = <3>;
		};
		port@4 {
			port_id = <5>;
			phy_address = <4>;
		};
	};
};

&soc {
    dp4: dp@4 {
        device_type = "network";
		compatible = "qcom,nss-dp";
		reg = <0x0 0x3a001600 0x0 0x200>;
		qcom,mactype = <0>;
        local-mac-address = [000000000000];
		qcom,id = <4>;
		phy-handle = <&qca8075_3>;
		phy-mode = "sgmii";
		label = "lan";
	};

    dp5: dp@5 {
        device_type = "network";
		compatible = "qcom,nss-dp";
		reg = <0x0 0x3a001800 0x0 0x200>;
		qcom,mactype = <0>;
        local-mac-address = [000000000000];
		qcom,id = <5>;
		phy-handle = <&qca8075_4>;
		phy-mode = "sgmii";
		label = "wan";
	};

};


&wifi {
 	qcom,ath11k-calibration-variant = "Yuncore-AX840";
	qcom,ath11k-fw-memory-mode = <0x01>;
	status = "okay";
};
